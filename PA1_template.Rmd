---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

<!-- Please set your working directory to this script's location :) -->

## Loading and preprocessing the data
```{r}
library(dplyr)
library(ggplot2)
library(lubridate)

DataFilePath<-'activity.csv'
if(!file.exists(DataFilePath))
{
  unzip('activity.zip')
}
StepData<-read.csv(DataFilePath)
```

## What is mean total number of steps taken per day?

```{r}

# Remove all observations that don't include steps.
# We will then group these items into individual days.
StepOnly<-filter(StepData, !is.na(steps))
StepsByDay<-group_by(StepOnly, date)

# From there, we can easily summarizethe total number of steps that we taken per day.
tspd<-summarise(StepsByDay, Total=sum(steps))

stepRange<-dist(range(tspd$Total))[[1]]

binCount<-10
binWidth<-stepRange / binCount

ggplot(data=tspd, aes(tspd$Total)) + 
       geom_histogram(binwidth=binWidth, fill="lightBlue", color="darkBlue") +
       ggtitle("Steps Per Day") +
       xlab("Total Steps") +
       ylab("Count")

options(scipen=1, digits=3)
meanTotalSteps<-mean(tspd$Total)
medTotalSteps<-median(tspd$Total)

```

Interesting Information:  
1. Mean Total Steps per Day: **`r meanTotalSteps`**  
2. Median Total Steps per Day: **`r medTotalSteps`**

## What is the average daily activity pattern?

```{r}

# Group the samples by their interval ID, and then get their mean values.
ByInterval<-group_by(StepOnly, interval)

# Get mean steps per interval.
mspi<-summarise(ByInterval, mean=mean(steps))

# Let's create a resonable looking x-axis that better denotes time.
# We are assuming that the day starts at midnight, and the data seems to support this since there are
# few steps at this time (i.e. sleeping)

breakCount<-6
MAX<-2400
breaks<-seq(from=0, by=(MAX/breakCount), length=breakCount)
xlabs<-paste(breaks / 100, "00", sep=":")

# Add the final values for the breaks/labels.
breaks<-append(breaks, 2355)
xlabs<-append(xlabs, "23:55")

# And now we plot.
ggplot(data=mspi, aes(x = interval, y=mean)) + 
       geom_line() +
       scale_x_discrete(limits=breaks, breaks=breaks, labels=xlabs) +
       xlab("Time of Day") +
       ylab("Mean Steps") +
       ggtitle("Daily Mean of Steps per Interval")


# Finally, we can decide which interval has the highest average across all days
maxIndex = which.max(mspi$mean)
maxInterval = mspi$interval[[maxIndex]]


```

The interval with the highest mean number of steps is: **`r maxInterval`**

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
